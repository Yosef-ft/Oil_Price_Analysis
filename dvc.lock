schema: '2.0'
stages:
  data_stage:
    cmd: python src/data/data_stage.py --config=params.yaml
    deps:
    - path: src/data/data_stage.py
      hash: md5
      md5: ab4b32124d6b39077875a3a40348bd97
      size: 1781
    params:
      params.yaml:
        base:
          random_state: 42
          verbose: 1
          batch_size: 32
          epochs: 1
        data:
          dataset_csv: data/BrentOilPrices.csv
          train_split: data/train_data.csv
          test_split: data/test_data.csv
          history_df: data/history_df.csv
          test_size: 60
          time_steps: 30
        output:
          report_dir: reports
          model_dir: models
    outs:
    - path: data/test_data.csv
      hash: md5
      md5: 0a9b2b371a67611413e899f842305498
      size: 1330
    - path: data/train_data.csv
      hash: md5
      md5: 4a7ec7a1d149c71f7f02958d1feaa20b
      size: 154921
  feature_stage:
    cmd: python src/features/featurize.py --config=params.yaml
    deps:
    - path: data/test_data.csv
      hash: md5
      md5: 0a9b2b371a67611413e899f842305498
      size: 1330
    - path: data/train_data.csv
      hash: md5
      md5: 4a7ec7a1d149c71f7f02958d1feaa20b
      size: 154921
    - path: src/features/featurize.py
      hash: md5
      md5: 98928c2bb8978b9934982f74f9610785
      size: 2168
    params:
      params.yaml:
        data:
          dataset_csv: data/BrentOilPrices.csv
          train_split: data/train_data.csv
          test_split: data/test_data.csv
          history_df: data/history_df.csv
          test_size: 60
          time_steps: 30
  train_stage:
    cmd: python src/train/train_model.py --config=params.yaml
    deps:
    - path: src/train/train_model.py
      hash: md5
      md5: 34b7102c4730322c63e26e8dccc0473f
      size: 5481
    params:
      params.yaml:
        data:
          dataset_csv: data/BrentOilPrices.csv
          train_split: data/train_data.csv
          test_split: data/test_data.csv
          history_df: data/history_df.csv
          test_size: 60
          time_steps: 30
        model:
          layers:
          - name: InputLayer
            shape:
            - 30
            - 1
          - name: LSTM
            units: 64
            activation: tanh
            return_sequences: false
          - name: Dense
            units: 8
            activation: relu
          - name: OutputLayer
            units: 1
            activation: linear
        report:
          model_path: models/LSTM.keras
          metrics_file: reports/metrics.json
          metrics_loss: reports/loss.png
          metrics_mse: reports/mean_squared_error.png
          metrics_mae: reports/mean_absolute_error.png
          metrics_RootMeanSquaredError: reports/root_mean_squared_error.png
        training:
          loss: mse
          optimizer: Adam
          learning_rate: 0.01
          metrics:
          - mae
          - mse
          - RootMeanSquaredError
          early_stopping:
            monitor: val_loss
            patience: 3
            mode: min
          model_path: models/model.joblib
    outs:
    - path: data/history_df.csv
      hash: md5
      md5: 6e8dfb5f4dc00fc6b251b27d5ccc0415
      size: 260
    - path: models/LSTM.keras
      hash: md5
      md5: 0337a0cde1bd841d314abfb0773c5938
      size: 238140
